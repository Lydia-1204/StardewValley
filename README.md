# 星露谷风格农场生活模拟游戏

> Tongji University · Software Engineering · 2024 Fall Program Design Paradigms Project

## 项目简介

本项目是一款星露谷风格的农场生活模拟游戏，围绕“经营农场 + 社区交互 + 探索冒险 + 角色成长”四条主线展开。玩家需要规划耕种、养殖、资源采集与经济系统，在与镇民互动的同时探索森林、矿洞等场景。我们以 Cocos2d-x + C++ 为主要技术栈，强调类与多态、STL、异常处理等现代 C++ 特性，以确保复杂系统间的解耦与健壮性。

## 团队信息

| 角色 | 姓名 | 主要职责 | 占比 |
| --- | --- | --- | --- |
| 2351882 | 王小萌 | 总体架构、角色创建、背包与工具栏、NPC 交互、Mini 地图、资源/资金管理、异常处理 | 30% |
| 2351591 | 刘彦含 | 动物与农作物系统、项目文档、Git 管理、资金面板、技能成长、市场价格、睡眠机制 | 30% |
| 2354178 | 陈美希 | 地图与碰撞、场景切换、NPC 交互与任务联动 | 20% |
| 2351273 | 邓语乐 | 工具交互、玩家系统、任务设计、角色动作表现 | 20% |

指导教师：赵钦佩  
学院/专业：同济大学计算机科学与技术学院 · 软件工程  
完成日期：2024-12-23

## 程序设计范式与技术特点

- **STL 容器**：大量使用 `std::vector` 等容器管理地图元素、NPC、动物与背包内容，实现动态扩展。
- **类与多态**：以面向对象的方式封装 NPC、工具、作物、动物等实体，复用通用接口并根据行为多态化实现细节。
- **模板与泛型**：对通用算法与资源容器进行模板化抽象，减少重复逻辑。
- **异常处理**：关键模块加入异常捕获，提升运行期稳定性与调试效率。

## 功能概览

### 基础功能

1. **农场经营**：耕种、浇水、施肥、收获；饲养牛/鸡/羊/猪/狗/猫等动物，并管理它们的健康与心情。
2. **社区交互**：与镇民对话、接取任务、赠送礼物、发展友谊及恋爱关系，完成后获得奖励。
3. **冒险探索**：在森林、矿洞、池塘等多地图切换，使用不同工具采集矿石、木材、鱼类等资源。
4. **角色成长**：农业、采矿、钓鱼、养殖等技能树随行为提升，可在属性面板中查看状态与成长进度。

### 扩展功能

1. **Mini 地图**：通过快捷键 `M` 查看全局定位，星形标记当前玩家位置，支持室内/室外/矿山切换。
2. **资金管理与商店**：可视化的资金面板与商店 UI，支持购买工具、礼物及出售产物。
3. **市场价格系统**：根据玩家持有量动态调整商品价格（如矿石 <30 稀有高价，≥30 走低），模拟供需机制。
4. **睡眠与时间快进**：在床边交互即可睡眠，暂停世界并将时间跳转至次日 8:00，恢复精力。
5. **工具动画与长按操作**：使用工具时触发对应动作，支持连续作业与行走速度切换。
6. **UI/交互增强**：任务窗口、角色/动物属性面板、心情与关系管理、精力守恒提示等。

## 功能技术细节

### 农场经营

- **生长周期驱动**：按游戏内时间累积进度与浇水状态决定作物成长；三天未浇水即视为干旱死亡。
- **动态纹理**：根据阶段切换贴图以展示生长动画，成熟时弹出提示；逾期未收获则枯萎。
- **动物 AI**：采用与玩家不同的移动逻辑沿预设路径漫游，并根据朝向切换精灵帧，营造生动效果。
- **动物交互**：右键查看状态，左键抚摸或喂食可提升健康/心情/好感；状态满值时可掉落对应产物。

### 社区交互

- **距离感知 UI**：靠近 NPC 时对话气泡由半透明变为不透明，提示可互动状态。
- **任务流**：首次对话触发任务领取，完成后再次交互即可结算奖励；之后进入随机闲聊模式。
- **礼物系统**：通过商店购买礼物，提升特定 NPC 好感度并解锁亲密关系。

### 冒险探索

- **工具上下文**：依据当前地图与手持工具决定可用动作（镐头挖矿、鱼竿钓鱼、斧头砍树等）。
- **资源累计**：采集成功时背包资源数量+1，并增加对应技能经验值。
- **属性可视化**：快捷键菜单实时展示经验条，方便玩家制定培养策略。

### 角色个人成长

- **属性面板**：使用快捷键 `P` 打开，显示钓鱼/种植/养殖/挖矿等技能等级以及精力、心情等指标。
- **阈值反馈**：技能达到 100 时将标识染成红色，强调该领域已达专家级。

### Mini 地图

- **全局定位**：快捷键 `M` 切换显隐，支持多场景地图拼接，星星与红色标签定位玩家。
- **场景同步**：室内外/矿山切换时保持坐标跟踪，帮助玩家快速规划路线。

### 资金与市场系统

- **初始定价**：每种可售物品设定基准价，商店面板可浏览价格表。
- **交易逻辑**：左键售卖、`BUY` 按钮购买，实时更新背包与资金；支持升级工具或购买礼物。
- **市场调节**：以持有量为输入对售价进行分段计算，模拟供过于求/供不应求场景。

### 睡眠与时间快进

- **触发条件**：玩家在家中且靠近床位时点击即可入睡，场景暂停。
- **快进机制**：再次点击床唤醒后时间跳至次日 08:00，并恢复满精力，提供合理节奏控制。

## 使用与操作说明

- **动物养殖**：左键互动；手持食物左键双击喂食；右键查看属性面板。
- **植物种植**：手持水壶左键浇水；手持肥料左键施肥。
- **工具栏**：左键使用工具，右键丢弃；`Shift` 可切换行走速度减半。
- **商店交互**：左键售卖，右键丢弃（礼物除外），点击 `BUY` 按钮购买。
- **快捷键总览**：`E` 暂停/继续 · `M` Mini 地图 · `C` 使用当前工具 · `V` 丢弃工具 · `P` 玩家属性 · `F` 任务窗口。
- **NPC 对话**：左键优先触发任务对话，第二次点击确认任务完成并领取奖励；再次对话进入随机日常聊天；右键打开好感度界面。

## 运行环境建议

- 操作系统：Windows 10/11
- IDE：Visual Studio 2022（含 C++ 桌面开发组件）
- 引擎依赖：Cocos2d-x（仓库已包含相关源码）
- 构建方式：打开 `proj.win32/StardewValley0.sln`，选择 Win32 Debug/Release 目标进行编译运行。

## 许可证与贡献

本仓库面向教学与课程展示使用，若需引用或二次开发，请联系团队成员或导师以确认授权。欢迎通过 Pull Request 或 Issue 提交建议与改进。